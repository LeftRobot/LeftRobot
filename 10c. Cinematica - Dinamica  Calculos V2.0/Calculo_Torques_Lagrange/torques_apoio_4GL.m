function [tor_Qa,tor_Ja,tor_Ta,tor_Da] = torques_apoio_4GL(Da,Ca,Ga,deriv_Q,deriv_J, deriv_T)

Theta_j = -deriv_J.thetaj;
tempo_j =  deriv_J.tempo;
[Thetaj_P, Thetaj_PP] = derivada(Theta_j, tempo_j);

% ** ---------------------------------------------------------------------
tht1_p  = deriv_Q.thetaq_P  + Thetaj_P  + deriv_T.thetat_P;
tht1_2p = deriv_Q.thetaq_PP + Thetaj_PP + deriv_T.thetat_PP;

tht2_p  = -deriv_T.thetat_P;
tht2_2p = -deriv_T.thetat_PP;

tht3_p  = -Thetaj_P; % **
tht3_2p = -Thetaj_PP; %**

tht4_p  = -deriv_Q.thetaq_P;
tht4_2p = -deriv_Q.thetaq_PP;

% ** ---------------------------------------------------------------------

%% TORQUE DA JUNTA K = 1 DEDAO EM APOIO
tau_1 = Da.d11.*(tht1_2p) + Da.d12.*(tht2_2p) + Da.d13.*(tht3_2p) +...
    Da.d14.*(tht4_2p) + Ca.C111.*(tht1_p.^2) +...
    (Ca.C121+Ca.C211).*(tht1_p.*tht2_p) + (Ca.C131+Ca.C311).*(tht1_p.*tht3_p) +...
    (Ca.C141+Ca.C411).*(tht1_p.*tht4_p) + Ca.C221.*(tht2_p.^2) +...
    (Ca.C231+Ca.C321).*(tht2_p.*tht3_p) + (Ca.C241+Ca.C421).*(tht2_p.*tht4_p) +...
    Ca.C331.*(tht3_p.^2) + (Ca.C341+Ca.C431).*(tht3_p.*tht4_p) +...
    Ca.C441.*(tht4_p.^2) + Ga.g1;

%% TORQUE DA JUNTA K = 2 TORNOZELO
tau_2 = Da.d21.*(tht1_2p) + Da.d22.*(tht2_2p) + Da.d23.*(tht3_2p) +...
    Da.d24.*(tht4_2p) + Ca.C112.*(tht1_p.^2) +...
    (Ca.C122+Ca.C212).*(tht1_p.*tht2_p) + (Ca.C132+Ca.C312).*(tht1_p.*tht3_p) +...
    (Ca.C142+Ca.C412).*(tht1_p.*tht4_p) +Ca.C222.*(tht2_p.^2) +...
    (Ca.C232+Ca.C322).*(tht2_p.*tht3_p) + (Ca.C242+Ca.C422).*(tht2_p.*tht4_p) +...
    Ca.C332.*(tht3_p.^2) + (Ca.C342+Ca.C432).*(tht3_p.*tht4_p) +...
    Ca.C442.*(tht4_p.^2) + Ga.g2; 

%% TORQUE DA JUNTA K = 3 JOELHO
tau_3 = Da.d31.*(tht1_2p) + Da.d32.*(tht2_2p) + Da.d33.*(tht3_2p) +...
    Da.d34.*(tht4_2p) + Ca.C113.*(tht1_p.^2) +...
    (Ca.C123+Ca.C213).*(tht1_p.*tht2_p) + (Ca.C133+Ca.C313).*(tht1_p.*tht3_p) +...
    (Ca.C143+Ca.C413).*(tht1_p.*tht4_p) + Ca.C223.*(tht2_p.^2) +...
    (Ca.C233+Ca.C323).*(tht2_p.*tht3_p) + (Ca.C243+Ca.C423).*(tht2_p.*tht4_p) +...
    Ca.C333.*(tht3_p.^2) + (Ca.C343+Ca.C433).*(tht3_p.*tht4_p) +...
    Ca.C443.*(tht4_p.^2) + Ga.g3;

%% TORQUE DA JUNTA K = 4 QUADRIL
tau_4 = Da.d41.*(tht1_2p) + Da.d42.*(tht2_2p) + Da.d43.*(tht3_2p) +...
    Da.d44.*(tht4_2p) + Ca.C114.*(tht1_p.^2) +...
    (Ca.C124+Ca.C214).*(tht1_p.*tht2_p) + (Ca.C134+Ca.C314).*(tht1_p.*tht3_p) +...
    (Ca.C144+Ca.C414).*(tht1_p.*tht4_p) + Ca.C224.*(tht2_p.^2) +...
    (Ca.C234+Ca.C324).*(tht2_p.*tht3_p) + (Ca.C244+Ca.C424).*(tht2_p.*tht4_p) +...
    Ca.C334.*(tht3_p.^2) + (Ca.C344+Ca.C434).*(tht3_p.*tht4_p) +...
    Ca.C444.*(tht4_p.^2) + Ga.g4;

% % TORQUE NO DEDAO EM APOIO
tor_Da = tau_1;

% % TORQUE DA JUNTA DO TORNOZELO NA FASE DE APOIO
tor_Ta = -tau_2;

% % TORQUE DA JUNTA DO JOELHO NA FASE DE APOIO
tor_Ja = -tau_3;

% % TORQUE DA JUNTA DO QUADRIL NA FASE DE APOIO
tor_Qa = -tau_4;

end